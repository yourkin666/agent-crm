# å¤–éƒ¨ Agent æŸ¥è¯¢æ¥å£æ–‡æ¡£

> æ–‡æ¡£æ›´æ–°æ—¶é—´ï¼š2025-08-07  
> æ¥å£ç‰ˆæœ¬ï¼šv1.0  
> é€‚ç”¨äºï¼šå¤–éƒ¨ Agent ç³»ç»Ÿå¸¦çœ‹è®°å½•æŸ¥è¯¢

---

## ğŸ“‹ æ¥å£æ¦‚è§ˆ

æœ¬æ–‡æ¡£ä¸“é—¨æè¿°å¤–éƒ¨ Agent ç³»ç»Ÿçš„ç”¨æˆ·å¸¦çœ‹è®°å½•æŸ¥è¯¢æ¥å£ï¼Œæä¾›å®Œæ•´çš„æŸ¥è¯¢åŠŸèƒ½å’Œè¯¦ç»†çš„å­—æ®µè¯´æ˜ã€‚

| æ¥å£åç§°         | æ–¹æ³• | è·¯å¾„                                     | åŠŸèƒ½æè¿°                     |
| ---------------- | ---- | ---------------------------------------- | ---------------------------- |
| ç”¨æˆ·å¸¦çœ‹è®°å½•æŸ¥è¯¢ | GET  | `/api/external/viewing-records/[userId]` | æ ¹æ®ç”¨æˆ· ID æŸ¥è¯¢å¸¦çœ‹è®°å½•ä¿¡æ¯ |

---

## ğŸ” ç”¨æˆ·å¸¦çœ‹è®°å½•æŸ¥è¯¢æ¥å£

### åŸºæœ¬ä¿¡æ¯

- **æ¥å£åœ°å€**: `GET /api/external/viewing-records/[userId]`
- **åŠŸèƒ½æè¿°**: æ ¹æ®ç”¨æˆ· ID æŸ¥è¯¢è¯¥ç”¨æˆ·çš„æ‰€æœ‰å¸¦çœ‹è®°å½•ä¿¡æ¯
- **æ•°æ®æ¥æº**: åŒæ—¶åŒ…å«å¤–éƒ¨ Agent ç³»ç»Ÿå’Œå†…éƒ¨ç®¡ç†ç•Œé¢åˆ›å»ºçš„è®°å½•
- **æ”¯æŒåŠŸèƒ½**:
  - åˆ†é¡µæŸ¥è¯¢
  - å¤šç»´åº¦ç­›é€‰ï¼ˆæˆ¿æºåç§°ã€å¸¦çœ‹çŠ¶æ€ã€ä¸šåŠ¡ç±»å‹ã€å¸¦çœ‹äººç±»å‹ã€æ—¶é—´èŒƒå›´ï¼‰
  - åŒæ—¶è¿”å›ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ï¼ˆå¦‚æœå­˜åœ¨å®¢æˆ·è®°å½•ï¼‰
  - å®Œæ•´çš„æˆ¿æºä¿¡æ¯ï¼ˆåŒ…å«å¤–éƒ¨ API è‡ªåŠ¨æŸ¥è¯¢çš„æ•°æ®ï¼‰
- **è¿”å›æ ¼å¼**: JSON

### è¯·æ±‚å‚æ•°

#### è·¯å¾„å‚æ•°

| å‚æ•°å   | ç±»å‹   | å¿…å¡« | è¯´æ˜                  |
| -------- | ------ | ---- | --------------------- |
| `userId` | string | âœ…   | ç”¨æˆ·ç¬¬ä¸‰æ–¹å”¯ä¸€æ ‡è¯† ID |

#### æŸ¥è¯¢å‚æ•°ï¼ˆURL å‚æ•°ï¼‰

| å‚æ•°å           | ç±»å‹   | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜                                                   |
| ---------------- | ------ | ---- | ------ | ------------------------------------------------------ |
| `page`           | number | âŒ   | 1      | é¡µç ï¼ˆä» 1 å¼€å§‹ï¼‰                                      |
| `pageSize`       | number | âŒ   | 20     | æ¯é¡µè®°å½•æ•°ï¼ˆæœ€å¤§ 100ï¼‰                                 |
| `property_name`  | string | âŒ   | -      | æˆ¿æºåç§°ï¼ˆæ¨¡ç³ŠåŒ¹é…ï¼‰                                   |
| `viewing_status` | number | âŒ   | -      | å¸¦çœ‹çŠ¶æ€ï¼ˆ1=å¾…ç¡®è®¤/2=å·²ç¡®è®¤/3=å·²å–æ¶ˆ/4=å·²å¸¦çœ‹ï¼‰        |
| `business_type`  | string | âŒ   | -      | ä¸šåŠ¡ç±»å‹ï¼ˆwhole_rent/shared_rent/centralizedï¼‰         |
| `viewer_name`    | string | âŒ   | -      | å¸¦çœ‹äººç±»å‹ï¼ˆinternal/external/external_sales/creatorï¼‰ |
| `date_from`      | string | âŒ   | -      | å¼€å§‹æ—¶é—´ï¼ˆYYYY-MM-DD æ ¼å¼ï¼‰                            |
| `date_to`        | string | âŒ   | -      | ç»“æŸæ—¶é—´ï¼ˆYYYY-MM-DD æ ¼å¼ï¼‰                            |

### å“åº”ç»“æœ

#### æˆåŠŸå“åº”

```json
{
  "success": true,
  "data": {
    "viewing_records": [
      {
        "id": 31,
        "customer_id": 9,
        "viewing_time": "2025-08-07T01:37:31.000Z",
        "property_name": "ä¸‡ç§‘åŸ",
        "property_address": "1æ ‹2å•å…ƒ301å®¤",
        "room_type": "two_bedroom",
        "room_tag": "loft",
        "viewer_name": "external",
        "viewing_status": 2,
        "commission": "3000.00",
        "viewing_feedback": 1,
        "business_type": "whole_rent",
        "notes": "å®¢æˆ·å¾ˆæ»¡æ„ï¼Œå‡†å¤‡ç­¾çº¦",
        "customer_name": "æå››",
        "customer_phone": "13900139000",
        "userId": "agent_user_12345",
        "botId": "bot_001",
        "housingId": 16351,
        "houseAreaId": 341,
        "houseAreaName": "é›å¡”åŒº",
        "cityId": 2899,
        "cityName": "è¥¿å®‰å¸‚",
        "propertyAddrId": 1097,
        "unitType": "3å®¤2å…2å«1å¨",
        "longitude": "108.983682",
        "latitude": "34.186379",
        "roomId": 61168,
        "advisorId": 6777,
        "advisorName": "è€¿é‡‘æ—",
        "companyName": "åŒ—äº¬æ°¸æ™Ÿå˜‰ä¸šæˆ¿åœ°äº§ç»çºªé›†å›¢æœ‰é™å…¬å¸",
        "companyAbbreviation": "æ°¸æ™Ÿé›†å›¢-æ¤°å£³å…¬å¯“",
        "houseTypeId": 70461,
        "created_at": "2025-08-07T09:37:31.000Z",
        "updated_at": "2025-08-07T09:37:31.000Z"
      }
    ],
    "customer_info": {
      "id": 9,
      "userId": "agent_user_12345",
      "nickname": "æå››",
      "name": "æå››",
      "phone": "13900139000",
      "community": "ä¸‡ç§‘åŸ",
      "business_type": "whole_rent",
      "room_type": "two_bedroom",
      "status": 1,
      "source_channel": "referral",
      "viewing_count": 5,
      "total_commission": "15000.00",
      "created_at": "2025-08-01T10:00:00.000Z",
      "updated_at": "2025-08-07T09:37:31.000Z"
    },
    "pagination": {
      "total": 5,
      "page": 1,
      "pageSize": 20,
      "totalPages": 1
    },
    "userId": "agent_user_12345"
  },
  "message": "æŸ¥è¯¢æˆåŠŸï¼Œæ‰¾åˆ°5æ¡å¸¦çœ‹è®°å½•"
}
```

---

## ğŸ“– å­—æ®µè¯¦ç»†è¯´æ˜

### å¸¦çœ‹è®°å½•å­—æ®µ (viewing_records)

#### åŸºç¡€ä¿¡æ¯å­—æ®µ

| å­—æ®µå             | ç±»å‹   | å¯ä¸ºç©º | è¯´æ˜                      |
| ------------------ | ------ | ------ | ------------------------- |
| `id`               | number | âŒ     | å¸¦çœ‹è®°å½•å”¯ä¸€æ ‡è¯† ID       |
| `customer_id`      | number | âœ…     | å…³è”çš„å®¢æˆ· IDï¼ˆå¯èƒ½ä¸ºç©ºï¼‰ |
| `viewing_time`     | string | âŒ     | å¸¦çœ‹æ—¶é—´ï¼ˆISO 8601 æ ¼å¼ï¼‰ |
| `property_name`    | string | âŒ     | æˆ¿æºåç§°                  |
| `property_address` | string | âœ…     | æˆ¿æºè¯¦ç»†åœ°å€              |
| `room_type`        | string | âŒ     | æˆ¿å‹ç±»å‹                  |
| `room_tag`         | string | âœ…     | æˆ¿å‹æ ‡ç­¾                  |
| `customer_name`    | string | âŒ     | å®¢æˆ·å§“åï¼ˆå†å²å¿«ç…§ï¼‰      |
| `customer_phone`   | string | âŒ     | å®¢æˆ·ç”µè¯ï¼ˆå†å²å¿«ç…§ï¼‰      |
| `userId`           | string | âœ…     | ç”¨æˆ·ç¬¬ä¸‰æ–¹ ID             |
| `botId`            | string | âœ…     | æœºå™¨äºº/å·¥ä½œäººå‘˜ ID        |
| `created_at`       | string | âŒ     | è®°å½•åˆ›å»ºæ—¶é—´              |
| `updated_at`       | string | âŒ     | è®°å½•æ›´æ–°æ—¶é—´              |

#### å¸¦çœ‹ä¸šåŠ¡å­—æ®µ

| å­—æ®µå             | ç±»å‹   | å¯ä¸ºç©º | è¯´æ˜                           | çŠ¶æ€è¯´æ˜                                                                                       |
| ------------------ | ------ | ------ | ------------------------------ | ---------------------------------------------------------------------------------------------- |
| `viewer_name`      | string | âŒ     | å¸¦çœ‹äººç±»å‹                     | `internal`=å†…éƒ¨å¸¦çœ‹<br/>`external`=å¤–éƒ¨å¸¦çœ‹<br/>`external_sales`=å¤–éƒ¨é”€å”®<br/>`creator`=åˆ›å»ºè€… |
| `viewing_status`   | number | âŒ     | å¸¦çœ‹çŠ¶æ€                       | `1`=å¾…ç¡®è®¤<br/>`2`=å·²ç¡®è®¤<br/>`3`=å·²å–æ¶ˆ<br/>`4`=å·²å¸¦çœ‹                                        |
| `commission`       | string | âŒ     | ä½£é‡‘é‡‘é¢ï¼ˆDecimal æ ¼å¼å­—ç¬¦ä¸²ï¼‰ | å•ä½ï¼šå…ƒï¼Œä¿ç•™ 2 ä½å°æ•°                                                                        |
| `viewing_feedback` | number | âœ…     | å¸¦çœ‹åé¦ˆ                       | `0`=æœªæˆäº¤<br/>`1`=å·²æˆäº¤<br/>`null`=æœªåé¦ˆ                                                    |
| `business_type`    | string | âŒ     | ä¸šåŠ¡ç±»å‹                       | `whole_rent`=æ•´ç§Ÿ<br/>`shared_rent`=åˆç§Ÿ<br/>`centralized`=é›†ä¸­å¼å…¬å¯“                          |
| `notes`            | string | âœ…     | å¸¦çœ‹å¤‡æ³¨                       | è‡ªç”±æ–‡æœ¬ï¼Œå¯ä¸ºç©º                                                                               |

#### æˆ¿å‹å­—æ®µè¯´æ˜

| `room_type` å€¼  | è¯´æ˜       |
| --------------- | ---------- |
| `one_bedroom`   | ä¸€å±…å®¤     |
| `two_bedroom`   | ä¸¤å±…å®¤     |
| `three_bedroom` | ä¸‰å±…å®¤     |
| `four_plus`     | å››å±…å®¤ä»¥ä¸Š |
| `master_room`   | ä¸»å§       |
| `second_room`   | æ¬¡å§       |

#### æˆ¿æºæ‰©å±•ä¿¡æ¯å­—æ®µ

| å­—æ®µå                | ç±»å‹   | å¯ä¸ºç©º | è¯´æ˜                                | æ•°æ®æ¥æº                |
| --------------------- | ------ | ------ | ----------------------------------- | ----------------------- |
| `housingId`           | number | âœ…     | æˆ¿æº ID                             | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `houseAreaId`         | number | âœ…     | åŒºåŸŸ ID                             | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `houseAreaName`       | string | âœ…     | åŒºåŸŸåç§°                            | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `cityId`              | number | âœ…     | åŸå¸‚ ID                             | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `cityName`            | string | âœ…     | åŸå¸‚åç§°                            | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `propertyAddrId`      | number | âœ…     | ç‰©ä¸šåœ°å€ ID                         | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `unitType`            | string | âœ…     | æˆ·å‹æè¿°ï¼ˆå¦‚"3 å®¤ 2 å… 2 å« 1 å¨"ï¼‰ | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `longitude`           | string | âœ…     | ç»åº¦                                | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `latitude`            | string | âœ…     | çº¬åº¦                                | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `roomId`              | number | âœ…     | æˆ¿é—´ ID                             | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `advisorId`           | number | âœ…     | é¡¾é—® ID                             | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `advisorName`         | string | âœ…     | é¡¾é—®å§“å                            | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `companyName`         | string | âœ…     | å…¬å¸åç§°                            | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `companyAbbreviation` | string | âœ…     | å…¬å¸ç®€ç§°                            | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |
| `houseTypeId`         | number | âœ…     | æˆ¿å‹ ID                             | å¤–éƒ¨ API æŸ¥è¯¢æˆ–æ‰‹åŠ¨å½•å…¥ |

### å®¢æˆ·ä¿¡æ¯å­—æ®µ (customer_info)

| å­—æ®µå             | ç±»å‹   | å¯ä¸ºç©º | è¯´æ˜          | çŠ¶æ€è¯´æ˜                                                                                                                                       |
| ------------------ | ------ | ------ | ------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- |
| `id`               | number | âŒ     | å®¢æˆ· ID       | ç³»ç»Ÿå†…éƒ¨å®¢æˆ·å”¯ä¸€æ ‡è¯†                                                                                                                           |
| `userId`           | string | âœ…     | ç”¨æˆ·ç¬¬ä¸‰æ–¹ ID | å¤–éƒ¨ç³»ç»Ÿç”¨æˆ·æ ‡è¯†                                                                                                                               |
| `nickname`         | string | âœ…     | å®¢æˆ·æ˜µç§°      | å¯ä¸ºç©º                                                                                                                                         |
| `name`             | string | âœ…     | å®¢æˆ·å§“å      | å¯ä¸ºç©º                                                                                                                                         |
| `phone`            | string | âœ…     | å®¢æˆ·ç”µè¯      | æ ¼å¼ï¼š1[3-9]xxxxxxxx                                                                                                                           |
| `community`        | string | âœ…     | å’¨è¯¢å°åŒº      | å®¢æˆ·æ„Ÿå…´è¶£çš„å°åŒº                                                                                                                               |
| `business_type`    | string | âŒ     | ä¸šåŠ¡ç±»å‹      | åŒå¸¦çœ‹è®°å½• business_type                                                                                                                       |
| `room_type`        | string | âŒ     | æˆ¿å‹åå¥½      | åŒå¸¦çœ‹è®°å½• room_type                                                                                                                           |
| `status`           | number | âŒ     | å®¢æˆ·çŠ¶æ€      | `1`=è·Ÿè¿›ä¸­<br/>`2`=ä¸å†å›å¤<br/>`3`=å·²çº¦å¸¦çœ‹<br/>`4`=å·²æˆäº¤æœªç»“ä½£<br/>`5`=å·²æˆäº¤å·²ç»“ä½£                                                         |
| `source_channel`   | string | âŒ     | æ¥æºæ¸ é“      | `xianyu`=é—²é±¼<br/>`xiaohongshu`=å°çº¢ä¹¦<br/>`beike`=è´å£³<br/>`58tongcheng`=58 åŒåŸ<br/>`shipinhao`=è§†é¢‘å·<br/>`douyin`=æŠ–éŸ³<br/>`referral`=æ¨è |
| `viewing_count`    | number | âŒ     | å¸¦çœ‹æ¬¡æ•°ç»Ÿè®¡  | è¯¥å®¢æˆ·æ€»å¸¦çœ‹æ¬¡æ•°                                                                                                                               |
| `total_commission` | string | âŒ     | æ€»ä½£é‡‘ç»Ÿè®¡    | è¯¥å®¢æˆ·äº§ç”Ÿçš„æ€»ä½£é‡‘ï¼ŒDecimal æ ¼å¼                                                                                                               |
| `created_at`       | string | âŒ     | å®¢æˆ·åˆ›å»ºæ—¶é—´  | ISO 8601 æ ¼å¼                                                                                                                                  |
| `updated_at`       | string | âŒ     | å®¢æˆ·æ›´æ–°æ—¶é—´  | ISO 8601 æ ¼å¼                                                                                                                                  |

### åˆ†é¡µä¿¡æ¯å­—æ®µ (pagination)

| å­—æ®µå       | ç±»å‹   | è¯´æ˜       |
| ------------ | ------ | ---------- |
| `total`      | number | æ€»è®°å½•æ•°   |
| `page`       | number | å½“å‰é¡µç    |
| `pageSize`   | number | æ¯é¡µè®°å½•æ•° |
| `totalPages` | number | æ€»é¡µæ•°     |

## ä¸»è¦çŠ¶æ€ç 

### å¸¦çœ‹çŠ¶æ€ (viewing_status)

- `1` = å¾…ç¡®è®¤
- `2` = å·²ç¡®è®¤
- `3` = å·²å–æ¶ˆ
- `4` = å·²å¸¦çœ‹

### å¸¦çœ‹åé¦ˆ (viewing_feedback)

- `0` = æœªæˆäº¤
- `1` = å·²æˆäº¤
- `null` = æœªåé¦ˆ

### å®¢æˆ·çŠ¶æ€ (status)

- `1` = è·Ÿè¿›ä¸­
- `2` = ä¸å†å›å¤
- `3` = å·²çº¦å¸¦çœ‹
- `4` = å·²æˆäº¤æœªç»“ä½£
- `5` = å·²æˆäº¤å·²ç»“ä½£

### ä¸šåŠ¡ç±»å‹ (business_type)

- `whole_rent` = æ•´ç§Ÿ
- `shared_rent` = åˆç§Ÿ
- `centralized` = é›†ä¸­å¼å…¬å¯“

### æˆ¿å‹ç±»å‹ (room_type)

- `one_bedroom` = ä¸€å±…å®¤
- `two_bedroom` = ä¸¤å±…å®¤
- `three_bedroom` = ä¸‰å±…å®¤
- `four_plus` = å››å±…å®¤ä»¥ä¸Š
- `master_room` = ä¸»å§
- `second_room` = æ¬¡å§

### å¸¦çœ‹äººç±»å‹ (viewer_name)

- `internal` = å†…éƒ¨å¸¦çœ‹
- `external` = å¤–éƒ¨å¸¦çœ‹
- `external_sales` = å¤–éƒ¨é”€å”®
- `creator` = åˆ›å»ºè€…

### æ¥æºæ¸ é“ (source_channel)

- `xianyu` = é—²é±¼
- `xiaohongshu` = å°çº¢ä¹¦
- `beike` = è´å£³
- `58tongcheng` = 58 åŒåŸ
- `shipinhao` = è§†é¢‘å·
- `douyin` = æŠ–éŸ³
- `referral` = æ¨è

## æŸ¥è¯¢å‚æ•°

- `page` - é¡µç  (é»˜è®¤ 1)
- `pageSize` - æ¯é¡µæ•°é‡ (é»˜è®¤ 20ï¼Œæœ€å¤§ 100)
- `property_name` - æˆ¿æºåç§°ç­›é€‰
- `viewing_status` - å¸¦çœ‹çŠ¶æ€ç­›é€‰
- `business_type` - ä¸šåŠ¡ç±»å‹ç­›é€‰
- `viewer_name` - å¸¦çœ‹äººç±»å‹ç­›é€‰
- `date_from` - å¼€å§‹æ—¶é—´ (YYYY-MM-DD)
- `date_to` - ç»“æŸæ—¶é—´ (YYYY-MM-DD)

## ä½¿ç”¨ç¤ºä¾‹

```bash
# æŸ¥è¯¢æ‰€æœ‰è®°å½•
curl "http://localhost:3000/api/external/viewing-records/user123"

# æŸ¥è¯¢å·²å®Œæˆå¸¦çœ‹
curl "http://localhost:3000/api/external/viewing-records/user123?viewing_status=4"

# æŸ¥è¯¢æˆäº¤è®°å½•
curl "http://localhost:3000/api/external/viewing-records/user123?viewing_feedback=1"
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯ç¤ºä¾‹

### åœºæ™¯ 1ï¼šæŸ¥è¯¢ç”¨æˆ·æ‰€æœ‰å¸¦çœ‹è®°å½•

```bash
curl -X GET "http://localhost:3000/api/external/viewing-records/agent_user_12345"
```

**é€‚ç”¨äº**: è·å–ç”¨æˆ·å®Œæ•´å¸¦çœ‹å†å²

### åœºæ™¯ 2ï¼šæŸ¥è¯¢ç”¨æˆ·æœ€è¿‘çš„æˆäº¤è®°å½•

```bash
curl -X GET "http://localhost:3000/api/external/viewing-records/agent_user_12345?viewing_feedback=1&page=1&pageSize=10"
```

**é€‚ç”¨äº**: è·å–ç”¨æˆ·æˆäº¤æƒ…å†µåˆ†æ

### åœºæ™¯ 3ï¼šæŸ¥è¯¢ç”¨æˆ·åœ¨æŒ‡å®šæ—¶é—´æ®µçš„å¸¦çœ‹æ´»åŠ¨

```bash
curl -X GET "http://localhost:3000/api/external/viewing-records/agent_user_12345?date_from=2024-08-01&date_to=2024-08-31"
```

**é€‚ç”¨äº**: æœˆåº¦/å­£åº¦æ´»åŠ¨ç»Ÿè®¡

### åœºæ™¯ 4ï¼šæŸ¥è¯¢ç”¨æˆ·ç‰¹å®šçŠ¶æ€çš„å¸¦çœ‹è®°å½•

```bash
curl -X GET "http://localhost:3000/api/external/viewing-records/agent_user_12345?viewing_status=4&business_type=whole_rent"
```

**é€‚ç”¨äº**: ç­›é€‰ç‰¹å®šç±»å‹çš„å·²å®Œæˆå¸¦çœ‹

---

## ğŸ“Š å“åº”çŠ¶æ€ç 

| HTTP çŠ¶æ€ç  | è¯´æ˜           | å“åº”ç¤ºä¾‹                                          |
| ----------- | -------------- | ------------------------------------------------- |
| 200         | æŸ¥è¯¢æˆåŠŸ       | `{"success": true, "data": {...}}`                |
| 400         | è¯·æ±‚å‚æ•°é”™è¯¯   | `{"success": false, "error": "userIdä¸ºå¿…å¡«å‚æ•°"}` |
| 500         | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | `{"success": false, "error": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"}`   |

---

## ğŸ”„ æ•°æ®æ›´æ–°è¯´æ˜

### æ•°æ®åŒæ­¥

- **å®æ—¶åŒæ­¥**: é€šè¿‡å¤–éƒ¨ Agent æ¥å£åˆ›å»ºçš„å¸¦çœ‹è®°å½•ç«‹å³å¯æŸ¥è¯¢
- **å†…éƒ¨åŒæ­¥**: é€šè¿‡å†…éƒ¨ç®¡ç†ç•Œé¢åˆ›å»ºçš„å¸¦çœ‹è®°å½•ä¹Ÿä¼šåŒ…å« userIdï¼ŒåŒæ ·å¯æŸ¥è¯¢
- **ç»Ÿè®¡æ›´æ–°**: å®¢æˆ·ç»Ÿè®¡ä¿¡æ¯ï¼ˆviewing_countã€total_commissionï¼‰åœ¨æ¯æ¬¡æ–°å¢å¸¦çœ‹è®°å½•åè‡ªåŠ¨æ›´æ–°

### æ•°æ®ä¸€è‡´æ€§

- **å†å²å¿«ç…§**: customer_name å’Œ customer_phone ä¿å­˜åˆ›å»ºæ—¶çš„å¿«ç…§ï¼Œä¸éšå®¢æˆ·ä¿¡æ¯å˜æ›´è€Œå˜åŒ–
- **å¤–éƒ¨æ•°æ®**: æˆ¿æºæ‰©å±•ä¿¡æ¯ä¼˜å…ˆä½¿ç”¨å¤–éƒ¨ API æŸ¥è¯¢ç»“æœï¼ŒæŸ¥è¯¢å¤±è´¥æ—¶ä½¿ç”¨æ‰‹åŠ¨å½•å…¥æ•°æ®
- **ç©ºå€¼å¤„ç†**: æ‰€æœ‰å¯ä¸ºç©ºå­—æ®µåœ¨å“åº”ä¸­æ˜ç¡®è¿”å› null è€Œä¸æ˜¯çœç•¥

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç”¨æˆ·æ ‡è¯†**: userId å¿…é¡»åœ¨åˆ›å»ºå®¢æˆ·æˆ–å¸¦çœ‹è®°å½•æ—¶æä¾›ï¼Œå†å²æ•°æ®ä¸­å¯èƒ½å­˜åœ¨ null å€¼
2. **åˆ†é¡µé™åˆ¶**: å•æ¬¡æŸ¥è¯¢æœ€å¤šè¿”å› 100 æ¡è®°å½•ï¼Œå»ºè®®æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´ pageSize
3. **ç­›é€‰æ€§èƒ½**: å»ºè®®ä¼˜å…ˆä½¿ç”¨ç´¢å¼•å­—æ®µï¼ˆviewing_statusã€viewing_timeï¼‰è¿›è¡Œç­›é€‰
4. **æ—¶é—´æ ¼å¼**: æ‰€æœ‰æ—¶é—´å­—æ®µå‡ä¸º ISO 8601 æ ¼å¼ï¼Œè¯·æ³¨æ„æ—¶åŒºå¤„ç†
5. **é‡‘é¢æ ¼å¼**: commission å’Œ total_commission ä¸º Decimal æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œè¯·æŒ‰å­—ç¬¦ä¸²å¤„ç†

---

## ğŸ”— ç›¸å…³æ¥å£

- [å®¢æˆ·æ•°æ®å½•å…¥æ¥å£](./å¤–éƒ¨Agentæ¥å£æ–‡æ¡£.md#å®¢æˆ·æ•°æ®å½•å…¥æ¥å£): `POST /api/external/customers`
- [å¸¦çœ‹è®°å½•å½•å…¥æ¥å£](./å¤–éƒ¨Agentæ¥å£æ–‡æ¡£.md#å¸¦çœ‹è®°å½•å½•å…¥æ¥å£): `POST /api/external/viewing-records`

---

**æ–‡æ¡£æ›´æ–°æ—¶é—´ï¼š2025-08-07**  
**å¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³»æŠ€æœ¯æ”¯æŒå›¢é˜Ÿã€‚**
