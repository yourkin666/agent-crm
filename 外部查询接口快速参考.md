# 外部查询接口快速参考

## 接口地址

```
GET /api/external/viewing-records/[userId]
```

## 主要状态码

### 带看状态 (viewing_status)

- `1` = 待确认
- `2` = 已确认
- `3` = 已取消
- `4` = 已带看

### 带看反馈 (viewing_feedback)

- `0` = 未成交
- `1` = 已成交
- `null` = 未反馈

### 客户状态 (status)

- `1` = 跟进中
- `2` = 不再回复
- `3` = 已约带看
- `4` = 已成交未结佣
- `5` = 已成交已结佣

### 业务类型 (business_type)

- `whole_rent` = 整租
- `shared_rent` = 合租
- `centralized` = 集中式公寓

### 房型类型 (room_type)

- `one_bedroom` = 一居室
- `two_bedroom` = 两居室
- `three_bedroom` = 三居室
- `four_plus` = 四居室以上
- `master_room` = 主卧
- `second_room` = 次卧

### 带看人类型 (viewer_name)

- `internal` = 内部带看
- `external` = 外部带看
- `external_sales` = 外部销售
- `creator` = 创建者

### 来源渠道 (source_channel)

- `xianyu` = 闲鱼
- `xiaohongshu` = 小红书
- `beike` = 贝壳
- `58tongcheng` = 58 同城
- `shipinhao` = 视频号
- `douyin` = 抖音
- `referral` = 推荐

## 查询参数

- `page` - 页码 (默认 1)
- `pageSize` - 每页数量 (默认 20，最大 100)
- `property_name` - 房源名称筛选
- `viewing_status` - 带看状态筛选
- `business_type` - 业务类型筛选
- `viewer_name` - 带看人类型筛选
- `date_from` - 开始时间 (YYYY-MM-DD)
- `date_to` - 结束时间 (YYYY-MM-DD)

## 使用示例

```bash
# 查询所有记录
curl "http://localhost:3000/api/external/viewing-records/user123"

# 查询已完成带看
curl "http://localhost:3000/api/external/viewing-records/user123?viewing_status=4"

# 查询成交记录
curl "http://localhost:3000/api/external/viewing-records/user123?viewing_feedback=1"
```
